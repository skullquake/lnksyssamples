<!DOCTYPE html>
<html>
	<head>
		<style>
			html,
			body{
				padding:unset;
				margin:unset;
				background:#000000;
			}
		</style>
		<link rel="stylesheet" href="./res/css/jquery.terminal/jquery.terminal-2.12.0.css"></link>
		<script src="/jquery.js"></script>
		<script src="/jquery.terminal.js"></script>
	</head>
	<body>
		<div id="t"></div>
		<script>
			$(document).ready(
				function(){
					$("#t").terminal(
						function(command,term){
							switch(command){
								case 'help':
									term.echo('Available Commands:');
									term.echo('\thelp');
									term.echo('\t\tprint help');
									term.echo('\treload');
									term.echo('\t\treload web page');
									term.echo('\ttestcon');
									term.echo('\t\ttest connection');
									term.echo('\txas');
									term.echo('\t\tserver repl');
									break;
								case 'reload':
									window.location.reload();
									break;
								case 'testcon':
									term.echo('testing connection...');
									$.get(
										'xas.js'
									).done(
										function(){
											term.echo('done');
										}
									).fail(
										function(){
											term.echo('error');
										}
									);
									break;
								case 'xas':
									term.push(
										function(command,term){
											if(command=='exit'){
												term.pop();
												return;
											}else{
												$.get(
													'xas.js',
													{
														cmd:command
													}
												).done(
													function(data){
														try{
															var obj_response=JSON.parse(data);
															if(typeof(obj_response)==='string'||obj_response instanceof String){
																term.echo("is string");
																term.echo(data);
															}else{
																if(Array.isArray(obj_response)){
																	term.echo("is array");
																	term.echo(JSON.stringify(obj_response));
																}else{
																	if(obj_response['type']==null){
																	}else{
																		switch(obj_response['type']){
																			case 'text':
																				if(typeof(obj_response['data'])==='string'||obj_response['data'] instanceof String){
																					term.echo(obj_response['data']);
																				}else{
																					term.echo(JSON.stringify(obj_response['data']));
																				}
																				break;
																			case 'js':
																				if(typeof(obj_response['data'])==='string'||obj_response['data'] instanceof String){
																					term.echo('feedback type:js');
																					eval(obj_response['data']);
																					break;
																				}else{
																					term.echo('No feedback data provided');
																				}
																				default:
																					term.echo('Invalid feedback type ('+obj_response['type']+')');
																					break;
																		}
																	}
																}
															}
														}catch(e){
															term.echo(data);
														}
													}
												).fail(
										function(){
											term.echo("Error: Ajax Failure");
										}
									);

											}
										}
									);
									break;
								default:
									term.echo('Error: Invalid command');
									break;
							}
						}
					);
				}
			);
		</script>
	</body>
</html>
